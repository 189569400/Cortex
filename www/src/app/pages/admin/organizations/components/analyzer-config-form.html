<section>
  <h4>Base details</h4>
  
  <div class="form-group">
    <label class="col-sm-3 control-label">Name</label>
    <div class="col-sm-9">
      <input class="form-control" type="text" name="name" ng-disabled="true" ng-model="$ctrl.analyzer.name" />
    </div>
  </div>
</section>

<section ng-show="$ctrl.definition.configurationItems.length > 0">
  <h4>Configuration</h4>  
  <configuration-form items="$ctrl.definition.configurationItems" configuration="$ctrl.analyzer.configuration"></configuration-form>
</section>

<section>
  <h4>Check TLP</h4>
  <div class="form-group">
    <label class="col-sm-3 control-label">Enable TLP check</label>
    <div class="col-sm-4">
      <div class="btn-group">
        <label uib-btn-radio="true" class="btn btn-default" ng-model="$ctrl.analyzer.configuration.check_tlp">True</label>
        <label uib-btn-radio="false" class="btn btn-default" ng-model="$ctrl.analyzer.configuration.check_tlp">False</label>        
      </div>
    </div>    
  </div>
  <div class="form-group" ng-show="$ctrl.analyzer.configuration.check_tlp">
    <label class="col-sm-3 control-label">Max TLP</label>
    <div class="col-sm-5">
      <select class="form-control" ng-model="$ctrl.analyzer.configuration.max_tlp" ng-options="tlp.value as tlp.key for tlp in $ctrl.Tlps"
        ng-required="$ctrl.analyzer.configuration.check_tlp"></select>
    </div>
  </div>
</section>

<section>
  <h4>Proxies</h4>
  <div class="form-group">
    <label class="col-sm-3 control-label">HTTP</label>
    <div class="col-sm-9">
      <input class="form-control" type="text" ng-model="$ctrl.analyzer.configuration.proxy_http">
      <p class="help-block">HTTP proxy</p>
    </div>    
  </div>
  <div class="form-group">
    <label class="col-sm-3 control-label">HTTPS</label>
    <div class="col-sm-9">
      <input class="form-control" type="text" ng-model="$ctrl.analyzer.configuration.proxy_https">
      <p class="help-block">HTTPS proxy</p>
    </div>    
  </div>
</section>

<section>
  <h4>Rate limiting</h4>
  <div class="form-group">
    <label class="col-sm-3 control-label">Rate</label>
    <div class="col-sm-4">
      <input class="form-control" type="number" ng-model="$ctrl.analyzer.rate">
    </div>
    <div class="col-sm-5">      
      <select class="form-control" ng-model="$ctrl.analyzer.rateUnit" ng-options="unit for unit in $ctrl.rateUnits">
        <option value="">-- choose unit --</option>
      </select>
    </div>    
  </div>  
</section>